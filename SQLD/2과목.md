# SQL 기본 및 활용

## 2-1 관계형 데이터베이스 개요

- 데이터베이스와 DBMS

    - 데이터베이스: 데이터의 집합 형식을 갖추지 않아도 엑셀 파일을 모아둔다면 그것 또한 데이터베이스임

    - DBMS: 데이터를 효과적으로 관리하기 위한 시스템

- 관계형 데이터베이스 구성 요소

    - 계정: 데이터의 접근 제한을 위한 여러 업무별/ 시스템별 계정이 존재

    - 테이블: DBMS의 DB 안에서 데이터가 저장 되는 형식

    - 스키마: 테이블이 어떠한 구성으로 되어 있는지, 어떠한 정보를 가지고 있는지에 대한 기본적인 구조 정의

- 테이블

    - 정의
        
        엑셀에서의 워크시트처럼 행과 열을 갖는 2차원 구조로 구성, 데이터를 입력하여 저장하는 최소 단위

    - 특징

        - 하나의 테이블은 반드시 하나의 유저 소유여야함

        - 테이블간 관계는 1:1, 1:다, 다:다의 관계를 가질수 있음

        - 테이블명은 중복될 수 없지만, 소유자가 다른 경우 같은 이름으로 생성 가능

    - 테이블은 행 단위로 입력, 삭제/ 수정은 개별값 수정 가능

- SQL

    - 관계형 데이터베이스에서 데이터 조회 및 조작, DBMS 시스템 관리 기능을 명령하는 언어

    - SQL 문법은 대소문자를 구분하지 X

- 관계형 데이터베이스 특징

    - 데이터의 무결성 보장

    - 기존의 작성된 스키마를 수정하기 어려움


- 데이터 무결성

    - 데이터의 정확성과 일관성을 유지하고, 데이터에 결손과 부정합이 없음을 보증하는 것

## 2-2 SELECT문

- SQL 종류

    - DDL: CREATE, ALTER, DROP, TRUNCATE - 정의어

    - DML: INSERT, DELETE, UPDATE, MERGE - 조작어

    - DCL: GRANT, REVOKE - 제어어

    - TCL: COMMIT, ROLLBACK

    - DQL: SELECT

- SELECT문 구조

    - SELCET문은 6개 절로 구성

    - FROM, WHERE, GROUP BY, HAVING, SELECT, ORDER BY

- SELCECT 절

    - SELECT 문장을 사용하여 불러올 컬럼명, 연산 결과를 작성하는 열

    - *를 사용하여 테이블 내 전체 컬럼명을 불러 올 수 있음

    - SELECT 절에서 표시할 대상 컬럼에 별칭 사용 가능
    
    - 대소문자 구분 X

- 별칭

    - 컬럼명 대신 출력할 임시 이름

    - 컬럼명 뒤에 AS와 함께 컬럼 별칭 전달(AS 생략 가능하나 웬만하면 작성)

    - 다음의 경우 별칭에 반드시 쌍따옴표 전달

        - 별칭에 공백 포함

        - 별칭에 특수문자를 포함

        - 대소문자 그대로 출력


- FROM 절

    - 데이터를 불러올 테이블명 또는 뷰명 전달
    
    - 테이블 여러 개 전달 가능

    - 테이블 별칭 선언 가능

    - ORACLE에서는 FROM 절 생략 불가

    - SQL Server에서는 FROM 절 생략 가능

## 2-3 함수

- 함수 정의

    - input value가 있을 경우 그에 맞는 output value 출력해주는 객체

    - from 절을 제외한 모든 절에서 사용 가능

- 다양한 함수 실전에서 익히도록.

## 2-4 WHERE 절

- 테이블의 데이터 중 원하는 조건에 맞는 데이터만 조회하고 싶을 경우 사용

- NULL 조회시 IS NULL/ IS NOT NULL 연산자 이용

- 연산자를 사용하여 다양한 표현이 가능

- 문자나 날짜 상수 표현시 반드시 홑따옴표 사용

## 2-5 GROUP BY 절

- 각 행을 특정 조건에 따라 그룹으로 분리하여 계산하도록 하는 구문식

- 그룹에 대한 조건은 WHERE 절에서 사용할 수 없음

- GROUP BY 절을 사용하면 데이터가 요약되므로 요약되기 전 데이터와 함께 출력할 수 없음

- GROUP BY 절은 컬럼과 집계 함수를 사용한 결과만 전달 가능

- HAVING 절

    - 그룹 함수 결과를 조건으로 사용할 때 사용하는 절

    - WHERE 절을 사용하여 그룹을 제한할 수 없으므로 HAVINFG 절에 전달

    - HAVING 절이 GROUP BY 절 앞에 올 수는 있지만 뒤에 쓰는 것을 권장


## 2-6 ORDER BY 절

- ORDER BY 절

    - 데이터는 입력된 순서대로 출력되나, 출력되는 행의 순서를 사용자가 변경하고자 할때 ORDER BY절을 사용

    - 유일하게 SELECT 절에 정의한 컬럼 별칭 사용 가능

    - 복합 정렬 사용 가능 (먼저 정렬한 값의 동일한 결과가 있을 경우 추가적으로 정렬 가능)

 - NULL의 정렬

    - NULL을 포함한 값의 정렬 시 ORACLE은 기본적으로 NULL을 마지막에 배치


## 2-7 조인

- 여러 테이블의 데이터를 사용하여 동시 출력하거나 참조 할 경우 사용

- FROM 절에 조인할 테이블 나열

- 동일한 열 이름이 여러 테이블에 존재할 경우 열 이름 앞에 테이블 이름이나 테이블 Alias 붙임

- 조인 종류

    - 조건의 형태에 따라

        - EQUI JOIN : JOIN 조건이 동등 조건인 경우

        - NON EQUI JOIN : JOIN 조건이 동등 조건이 아닌 경우

    - 조인 결과에 따라

        - INNER JOIN: JOIN 조건에 성립하는 데이터만 출력하는 경우

        - OUTER JOIN: JOIN 조건에 성립하지 않는 데이터도 출력하는 경우

    
    - 그외

        - NATURAL, CROSS, SELF JOIN

- EQUI JOIN(등가 조인)

    - 조인 조건이 '=(EQUAL)' 비교를 통해 같은 값을 가지는 행을 연결하여 결과를 얻는 방법

    - SQL 명령분에서 가장 많이 사용하는 조인 방법

- NON-EQUI JOIN

    - 테이블 연결짓는 조인 컬럼에 대한 비교 조건이 BETWEEN같이 '='이 아닌 연산자를 사용하는 경우의 조건

- 세 테이블 이상의 조인

    - 관계를 잘 파악하여 모든 테이블이 연결 되도록 조인 조건 명시

    - N개 테이블의 겨웅 최소 N-1개의 조인 조건 필요

- SELF JOIN

    - 한테이블 내 각 행끼리 관계를 갖는 경우 사용하는 조인 기법

    - 한 테이블을 참조할 때마다 명시해야 함

## 2-8 표준 조인

- 표준 조인

    - ANSI표준으로 작성되는 INNER, CROSS, NATURAL, OUTER를 말함

- INNER  조인

    - 내부 조인이라고 하며, 조인 조건이 일치하는 행만 추출

- ON절

    - 조인할 양 컬럼의 컬럼명이 서로 다르더라도 사용 가능

    - ON 조건의 괄호는 옵션

- USING 조건절

    - 조인할 컬럼명이 같을 경우 사용

    - 괄호 필수

- NATURAL JOIN

    - 두 테이블간의동일한 이름을 가지는 모든 컬럼들에 대해 EQUI JOIN을 수행

    - USING, ON, WHERE 절에서 조건 정의 불가

    - 동일한 이름의 모든 컬럼을 조인 컬럼으로 사용하므로 조인 컬럼의 값이 모두 같을 때만 결과가 리턴됨

- CROSS JOIN

    - 테이블 간 JOIN 조건이 없는 경우 생성 가능한 모든 데이터들의 조합

    - N * M

- OUTER JOIN

    - INNER JOIN과 대비되는 조인 방식

    - JOIN 조건에서 동일한 값이 없는 행도 반환할 때 사용

    - OUTER JOIN 종류

        - LEFT OUTER

            FROM절에 나열된 왼쪽 테이블에 해당하는 데이터를 읽은 후, 우측 테이블에서 JOIN 대상 읽어옴

        - RIGHT OUTER

            LEFT 반대

        - FULL OUTER JOIN

            두 테이블 전체 기준으로 결과를 생성하여 중복 데이터는 삭제 후 리턴